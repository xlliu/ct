{% extends "base.html" %}
{% block content %}
         <div id="page-wrapper" style="margin-left:auto;margin-right:auto;width: 1200px">
            <div class="row">
                <div class="col-lg-12">
                    <h1 class="page-header">任务列表</h1>
                </div>


            </div>
            <!-- /.row -->
            <div class="row">
                <div class="col-lg-12">
                    <div class="panel panel-default">
                            <a href="/add_task" class="btn btn-primary" style="float:right;margin:5px 15px">新增任务</a>
                            <a href="/show_log" class="btn btn-primary" style="float:right;margin:5px 5px">显示日志</a>
                        </div>
                        <!-- /.panel-heading -->
                        <div class="panel-body">
                            <div class="dataTable_wrapper">
                                <table class="table table-striped table-bordered table-hover" id="dataTables-example">
                                    <thead>
                                        <tr>
                                            <th>任务名</th>
                                            <th>任务状态</th>
                                            <th>最后执行结果</th>
                                            <th>最后执行开始时间</th>
                                            <th>最后执行结束时间</th>
                                            <th>命令</th>
                                            <th>corn时间</th>
                                            <th>下次运行时间</th>
                                            <th>操作</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                    {% for d in data %}
                                        <tr class="odd gradeX">
                                            <td>{{ d.name }}</td>
                                             <td {% if d.status=='开启'%}style='background-color: #43fab8' {% else %}style='background-color: #fc5d6c'{% endif %}>{{ d.status }}</td>
                                            <td {% if d.lastresult=='成功' %}style='background-color: #43fab8'{% elif d.lastresult=='运行中' %}style='background-color: #eeff94'{% else %}style='background-color: #fc5d6c'{% endif %}>{{ d.lastresult }}</td>
                                            <td>{{ d.lastbegin }}</td>
                                            <td>{{ d.lastend }}</td>
                                            <td>{{ d.command }}</td>
                                            <td>{{ d.cron }}</td>
                                            <td>{{ d.nextruntime }}</td>
                                            <td align="center">
                                                <a href="/get_log?id={{ d.id }}" class="btn btn-default" style="width:66px;height:34px">日志</a>
                                                <a href="/task_detail?id={{ d.id }}" class="btn btn-default" style="width:66px;height:34px">详情</a>
                                                <a href="/delete_task?id={{ d.id }}" class="btn btn-default" style="width:66px;height:34px" onclick="del()">删除</a>
                                            </td>
                                        </tr>
                                    {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <!-- /.panel-body -->
                    </div>
                    <!-- /.panel -->
                </div>
                <!-- /.col-lg-12 -->
            </div>
            <!-- /.row -->
        </div>
        <script type="text/javascript">
            function del(){
                if (!confirm('确认删除任务？')){
                    window.event.returnValue = false;
                }
            }
        </script>
{% endblock %}
